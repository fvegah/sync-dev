---
phase: 04-native-macos-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/vite.config.js
  - frontend/svelte.config.js
  - frontend/src/app.css
autonomous: true

must_haves:
  truths:
    - "Svelte 5 is installed and builds successfully"
    - "Tailwind CSS v4 is configured and working"
    - "Vite builds without errors"
  artifacts:
    - path: "frontend/package.json"
      provides: "Svelte 5 + Tailwind v4 dependencies"
      contains: "svelte.*5"
    - path: "frontend/svelte.config.js"
      provides: "Svelte 5 configuration"
    - path: "frontend/src/app.css"
      provides: "Tailwind CSS imports and global styles"
      contains: "@import 'tailwindcss'"
  key_links:
    - from: "frontend/vite.config.js"
      to: "@sveltejs/vite-plugin-svelte"
      via: "Svelte plugin configuration"
      pattern: "svelte\\(\\)"
---

<objective>
Upgrade frontend foundation from Svelte 3 to Svelte 5 and add Tailwind CSS v4

Purpose: Svelte 5's runes system is required for shadcn-svelte components. Tailwind v4 provides 5x faster builds and modern CSS features for macOS-style UI.

Output:
- Upgraded package.json with Svelte 5, Tailwind CSS v4, lucide-svelte
- Configured vite.config.js and svelte.config.js for Svelte 5
- Global CSS with Tailwind imports and system font
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-native-macos-ui/04-RESEARCH.md

@frontend/package.json
@frontend/vite.config.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Upgrade to Svelte 5 with dependencies</name>
  <files>frontend/package.json, frontend/vite.config.js</files>
  <action>
In frontend/ directory:

1. Upgrade Svelte 3 -> 5 (skip intermediate Svelte 4 as this is a simple project):
```bash
cd frontend
npm install svelte@latest @sveltejs/vite-plugin-svelte@latest
```

2. Install Tailwind CSS v4 and PostCSS:
```bash
npm install -D tailwindcss@latest postcss autoprefixer
npx tailwindcss init -p
```

3. Install Lucide icons for Svelte:
```bash
npm install lucide-svelte
```

4. Install clsx and tailwind-merge for shadcn-svelte (prep for next plan):
```bash
npm install clsx tailwind-merge
```

5. Update vite.config.js for Svelte 5:
```javascript
import { defineConfig } from 'vite'
import { svelte } from '@sveltejs/vite-plugin-svelte'

export default defineConfig({
  plugins: [svelte()],
  build: {
    outDir: 'dist',
    emptyOutDir: true
  }
})
```

IMPORTANT: Do NOT run the migration script yet. Manual migration will happen in later plans to ensure $derived is used instead of $effect.
  </action>
  <verify>
Run `cd frontend && npm install` completes without errors.
Run `npm run build` shows no fatal errors (warnings about Svelte 3 syntax are expected at this stage).
Check package.json shows svelte version starting with "5.".
  </verify>
  <done>
package.json has Svelte 5.x, Tailwind CSS 4.x, lucide-svelte installed.
vite.config.js uses @sveltejs/vite-plugin-svelte with svelte() plugin.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create svelte.config.js and configure Tailwind CSS</name>
  <files>frontend/svelte.config.js, frontend/tailwind.config.js, frontend/postcss.config.js</files>
  <action>
1. Create frontend/svelte.config.js:
```javascript
import { vitePreprocess } from '@sveltejs/vite-plugin-svelte'

export default {
  preprocess: vitePreprocess(),
  compilerOptions: {
    // Enable runes mode for Svelte 5
    runes: true
  }
}
```

2. Update frontend/tailwind.config.js with macOS theme tokens:
```javascript
/** @type {import('tailwindcss').Config} */
export default {
  content: ['./src/**/*.{html,js,svelte,ts}'],
  darkMode: 'media', // Uses prefers-color-scheme for automatic dark mode
  theme: {
    extend: {
      colors: {
        // macOS system colors
        'macos-blue': '#007AFF',
        'macos-green': '#34C759',
        'macos-orange': '#FF9500',
        'macos-red': '#FF3B30',
        'macos-gray': '#8E8E93',
        // Sidebar colors
        'sidebar-light': 'rgba(255, 255, 255, 0.3)',
        'sidebar-dark': 'rgba(17, 24, 39, 0.3)',
      },
      fontFamily: {
        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
      },
    },
  },
  plugins: [],
}
```

3. Verify frontend/postcss.config.js exists (created by tailwindcss init -p):
```javascript
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
```
  </action>
  <verify>
Files exist: frontend/svelte.config.js, frontend/tailwind.config.js, frontend/postcss.config.js.
Run `npm run build` in frontend/ directory completes (warnings allowed).
  </verify>
  <done>
svelte.config.js enables runes mode.
tailwind.config.js has macOS color tokens and system font.
postcss.config.js configures Tailwind.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create global CSS with Tailwind and system font</name>
  <files>frontend/src/app.css, frontend/src/main.js</files>
  <action>
1. Create frontend/src/app.css with Tailwind imports and global styles:
```css
@import 'tailwindcss';

/* macOS system font and base styles */
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  margin: 0;
  padding: 0;
  overflow: hidden;
  /* Dark mode base colors */
  @apply bg-slate-900 text-slate-100;
}

/* Light mode overrides */
@media (prefers-color-scheme: light) {
  body {
    @apply bg-white text-slate-900;
  }
}

* {
  box-sizing: border-box;
}

/* Utility for macOS-style vibrancy */
.macos-vibrancy {
  @apply backdrop-blur-md backdrop-saturate-150;
}
```

2. Update frontend/src/main.js to import app.css:
```javascript
import './app.css'
import App from './App.svelte'

const app = new App({
  target: document.getElementById('app'),
})

export default app
```

Note: The main.js syntax will be updated to Svelte 5's mount() in a later plan when App.svelte is migrated.
  </action>
  <verify>
Run `npm run dev` in frontend/ starts without CSS errors.
Open browser devtools and verify body has system font applied.
Tailwind classes like `bg-slate-900` are recognized.
  </verify>
  <done>
app.css imports Tailwind and sets system font.
main.js imports app.css.
Dark/light mode base styles are configured.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:
1. `cd frontend && npm run build` succeeds (warnings allowed for unmigrated Svelte 3 syntax)
2. `npm run dev` starts development server
3. package.json shows: svelte ^5.x, tailwindcss ^4.x, lucide-svelte installed
4. svelte.config.js exists with runes: true
5. tailwind.config.js has macOS colors and darkMode: 'media'
</verification>

<success_criteria>
- Svelte 5 installed and Vite plugin configured
- Tailwind CSS v4 configured with macOS color tokens
- System font stack applied globally
- Dark mode detection via prefers-color-scheme
- Build succeeds (warnings for old syntax allowed)
</success_criteria>

<output>
After completion, create `.planning/phases/04-native-macos-ui/04-01-SUMMARY.md`
</output>
